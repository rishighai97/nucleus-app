!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("xlsx")):"function"==typeof define&&define.amd?define("cdk-table-exporter",["exports","@angular/core","xlsx"],e):e(t["cdk-table-exporter"]={},t.ng.core,t.XLSX)}(this,function(t,r,p){"use strict";var e=function(){function t(){}return t.decorators=[{type:r.NgModule,args:[{declarations:[],imports:[],exports:[]}]}],t}(),n=function(){function t(t,e){this.renderer=t,this.jsonExporter=e,this.sheetName="Sheet1",this.fileName="export.xlsx",this.exportCompleted=new r.EventEmitter,this.exportStarted=new r.EventEmitter}return t.prototype.ngAfterViewInit=function(){var e=this;this.renderer.listen(this.exporterButton._elementRef.nativeElement,"click",function(t){e.exportTable()})},t.prototype.exportTable=function(){this.exportStarted.emit(),this._isIterating=!0,this._isExporting=!0,this._data=new Array,this.enableExportButton(!1);try{this.exportWithPagination()}catch(t){this.exportSinglePage()}},t.prototype.exportWithPagination=function(){this._initialPageIndex=this.getCurrentPageIndex(),this.initPageHandler(),this.goToPage(0)},t.prototype.exportSinglePage=function(){this.extractDataOnCurrentPage(),this.exportExtractedData()},t.prototype.extractDataOnCurrentPage=function(){this._data=this._data.concat(this.extractExcelRows())},t.prototype.initPageHandler=function(){var e=this;this.getPageChangeObservable().subscribe(function(t){setTimeout(function(){e._isIterating?(e.extractDataOnCurrentPage(),e.hasNextPage()?e.nextPage():(e._isIterating=!1,e.goToPage(e._initialPageIndex))):e._isExporting&&(e._isExporting=!1,e.exportExtractedData())})})},t.prototype.exportExtractedData=function(){this.jsonExporter.exportExcel(this.extractExcelHeaderRow(),this._data,this.fileName,this.sheetName),this._data=new Array,this.enableExportButton(!0),this.exportCompleted.emit()},t.prototype.extractExcelRows=function(){return this.convertToJsonArray(this.getRenderedRows(this.cdkTable._rowOutlet))},t.prototype.extractExcelHeaderRow=function(){return this.convertToJsonArray(this.getRenderedRows(this.cdkTable._headerRowOutlet))[0]},t.prototype.getRenderedRows=function(t){return this.cdkTable._getRenderedRows(t)},t.prototype.convertToJsonArray=function(t){for(var e=new Array,r=0;r<t.length;r++){var n=this.convertRow(t[r]);this.customizeRow(n),e.push(this.createExcelItem(n))}return e},t.prototype.convertRow=function(t){for(var e=new Array,r=t.children,n=0;n<r.length;n++)if(!this.shouldHide(n)){var o=r.item(n).innerText;e.push(o)}return e},t.prototype.shouldHide=function(t){return!(!this.hiddenColumns||!this.hiddenColumns.includes(t))},t.prototype.customizeRow=function(t){return t},t.prototype.createExcelItem=function(t){return Object.assign({},t)},t.prototype.hasNextPage=function(){return this.getCurrentPageIndex()<this.getPageCount()-1},t.prototype.nextPage=function(){this.goToPage(this.getCurrentPageIndex()+1)},t.prototype.enableExportButton=function(t){this.renderer.setProperty(this.exporterButton._elementRef.nativeElement,"disabled",t?null:"true")},t.propDecorators={cdkTable:[{type:r.Input}],exporterButton:[{type:r.Input}],sheetName:[{type:r.Input}],fileName:[{type:r.Input}],hiddenColumns:[{type:r.Input}],exportCompleted:[{type:r.Output}],exportStarted:[{type:r.Output}]},t}(),o=function(){function t(){}return t.prototype.exportExcel=function(t,e,r,n,o){if(e.unshift(t),o)for(var i=0;i<e.length;i++)e[i]=this.hideColumns(o,e[i]);var a=p.utils.book_new(),s=p.utils.json_to_sheet(e,{skipHeader:!0});p.utils.book_append_sheet(a,s,n),r=this.appendExtensionIfNotProvided(r),p.writeFile(a,r)},t.prototype.hideColumns=function(t,e){for(var r=0;r<t.length;r++){delete e[t[r]]}},t.prototype.appendExtensionIfNotProvided=function(t){return t.includes(i.XLSX)||t.includes(i.XLS)||(t=t.concat(i.XLSX)),t},t.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=r.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),i={XLSX:".xlsx",XLS:".xls"};t.CdkTableExporter=n,t.JsonExporterService=o,t.CdkTableExporterModule=e,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=cdk-table-exporter.umd.min.js.map